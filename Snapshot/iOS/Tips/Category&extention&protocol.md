## 一、Category

### 1.1 分类用途

1. 给已有的类添加新的方法。
2. 将一个复杂的类的实现分割到不同的文件当中。
3. 在写一个库的时候，可以将一个类的某些方法对用户进行隐藏而对库内的类可见。



### 1.2 分类的好处

1. 不必使用继承就能够方便的给类添加新的方法。
2. 通过按功能对类进行分割，能够使类的代码结构更清晰、易读，同时单个类的代码量也有所减少。
3. 分割后的代码也更易于调试，在backtrace当中能够方便的追踪到问题代码。
4. 分割后的代码也更容易管理。



### 1.3 分类的原理

要想从0还是了解分类的原理，需要的附加知识有很多，这里只说一些我在整个思考过程中一些比较重要的点。

* runtime的发展过程

  * 面向对象相对于面向过程的优点

  * 面向对象的C语言-objc的实现

    1. Preproccessor - 实现objc到C的编译过程

    2. 基于C结构的OOP对象模型
    3. 对消息机制（以及自省和NSObeject）进行支持的runtime

* 类的加载过程

* Category源码分析（这是一个艰难长期的过程）



#### 1.3.1 runtime的发展过程

##### 1 面向对象编程的好处

对于面向对象编程的好处偶尔我有了一点点的领悟。

想想实际的开发场景，当利用面向对象的思想去编写程序，首先想到的是我要搞一个对象！然后让他有某些属性和能力，这个对象的能力的具体实现可以暂时先不考虑，等到整个系统使用面向对象的思想设计完毕的时候，再去完成实现的细节，之后就让这个对象去做那些我让他做的事情。然而，面向过程编程的时候，我们首先想到的是，第一步我要干什么，第二步以及以后我要干什么，注意力全都集中在完成我要做的事情的步骤上，跟对象没啥关系，整个程序本身就是一个具备各种功能对大对象。

举例来对比一下。比如说，我要打电话。如果利用面向对象的思想的话，那么我就要搞一个手机对象出来，让这个手机对象有一项能力，那就是打电话，这样我要发短信的时候就可以造一个手机对象出来，然后告诉他给我打个电话出去；如果利用面向过程的思想的话，我一开始就需要考虑细节，第一步拨号，第二步发送拨打信号，第三步监听是否联通…….等等。在我只想做一件事情的情况下，事情还没有那么糟糕，但是，当我想打电话，又想洗衣服，又想写代码，又想……干很多很多事情的时候，面向过程的思想方式可能就应付不来了，因为有太多的细节需要考虑，步骤多而繁杂，每件事情相互之间并没有什么联系却要一起进行考虑，而面向对象就可以把这些事情拆分到不同的对象当中去，让这些对象和谐共存，一起构建起一个有序的系统。

实际上，经过以上对比可以看到，当我们利用面向对象的思想去思考问题的时候，整个系统是由一系列的对象构建而成的，理想的情况下，每个对象都有他自己专门的职责，这些职责由对象所拥有的功能进行完成，这更符合我们所生活的世界的思维逻辑，整个世界就是由一个一个的对象构造而成的不是吗？这让我们在做大型的系统的时候，能够更容易更清晰的去进行设计。

**注：我还没有写过面向过程编程的程序，不知道面向过程的具体编程场景是怎样的，此处存在我对面向过程变成的猜测，可能会在理解上有所误解。但是面向对象编程我已经有了很多的经验，这里的理解不会有太大的错误。**



##### 2 基于C语言的面向对象的Objective-C

面向对象的好处可能我只领会了冰山的一角，但是足以见到他在大型软件设计当中所能发挥的威力。正因为面向对象的好处众多，Brad Cox 和 Tom Love在多年以前萌生了搞出一个易用且轻量的 C 语言扩展的想法，这种扩展语言能够像SmallTalk一样，既具有面向对象的能力又具有消息机制，这就是Objective-C最初始的一些想法。有了这些想法之后，他们采用了一系列的技术手段进行实现：

* 首先，他们开发了一个Preproccessor，用于将Objective-C的语法进行解析，然后转换成C语言进行编译。

* 只是能够将其解析为C还远远不够，还需要一个基于C实现的面向对象编程的对象模型（我认为这个对象模型就是runtime当中定义的那些数据结构），这能够让编译器知道将Objective-C具体编译成什么样的C。 

  **注：写这块的时候，我不太知道解析器和编译器他们具体都做什么，所以这块应该是有错误。**

* 完成了以上两点，还剩下最后一个任务，实现消息机制，将Objective-C层面的消息发送进行底层的实现，所有的实现的函数最终打包在一起就是runtime。

**以上写的肯定有错误，但是基于此刻的理解，这是我现在所能理解的最高高度。**

可以看出，我们在顶层利用Objective-C进行编程，能够使用面向对象的思想对系统设计带来的巨大便利，同时又能够使用消息机制让代码运行的更加灵活，而runtime在底层为我们默默地做着一切。

学习好runtime，对我们以后进行面向对象的代码设计一定能够带来很多的好处，同时又能够了解类的机制。我们不应该仅仅局限于在上层用Objective-C进行编程，还需要了解Objective-C的底层原理，这样不仅能够纵深知识的深度，也能扩展知识的维度，对以后我们了解其他语言以及更好的使用Objective-C进行编程有莫大的好处。可以说，runtime是必学的东西，在整个iOS的知识框架里边，他绝对可以算得上是核心。

#### 1.3.2  类的加载过程

#### 1.3.3  Category源码分析



### 1.4 相关扩展

* Category为什么只能加方法不能加属性？如何能给分类添加属性？这种方法的原理是什么？
* Category中有load方法吗？load方法是什么时候调用的？load 方法能继承吗？
* load、initialize的区别，以及它们在category重写的时候的调用的次序。
* 语言动态特性的好处是什么？





## 二、Extention

## 三、Protocol







